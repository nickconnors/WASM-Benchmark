<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>WebAssembly Performance Test</title>
  </head>
  <body>
    <h1>WebAssembly Performance Test</h1>
    <button onclick="calcPrimesWASM()">WASM</button>
    <button onclick="calcPrimesJS()">JS</button>
    <script src="primes.js"></script>
    <script type="text/javascript">
      calcPrimesWASM = cwrap('calcPrimes', null, null)

      function isPrime(n) {
        for (let i = 2; i <= n/2; i++) {
          if (!(n % i)) {
            return 0;
          }
        }
        return 1;
      }

      function calcPrimesJS() {
        var numPrimes = 0;

        var time = performance.now();

        for (let i = 2; i < 1000001; i++) {
          numPrimes += isPrime(i);
        }

        time = performance.now() - time;

        console.log(numPrimes);
        console.log("Time taken: " + time / 1000);
      }
    </script>
  </body>
</html>
